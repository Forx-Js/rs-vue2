"use strict";(self.webpackChunkrs_vue2=self.webpackChunkrs_vue2||[]).push([["124"],{2882:function(e,t,r){r.r(t),r.d(t,{default:()=>h});var n=r(5400),i=r(5792),s=r(9734),l=r(6517),o=r(3655);let a={components:{MangerPane:i.Z},setup(){let e=(0,n.iH)(),{iframeUrl:t,token:r}=(0,o.u)("kk-doc","aHR0cDovL2xvY2FsaG9zdDozMDAwL2trL2RlbW8v5paw5bu6IE1pY3Jvc29mdCBXb3JkIOaWh%2Bahoy5kb2N4"),i=new s.Z5;return{token:r,iframe:e,iframeUrl:t,manager:i,onFrameLoad:function(){i.setIframe(e.value),i.add([new l.$b({mark:[.2,.2],points:[.2,.1,.6,.125],index:1,scale:1,lineWidth:1,strText:"99999999"}),new l.$b({mark:[.4,.65],points:[.3,.7,.35,.725],index:8,scale:1,color:255,strText:"22222"}),new l.bR({points:[.3,.7,.35,.725],index:1,scale:1,color:255})])}}}},h=(0,r(4964).Z)(a,function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"bar fixed top-0 z-1"},[t("input",{directives:[{name:"model",rawName:"v-model.lazy",value:e.token,expression:"token",modifiers:{lazy:!0}}],staticClass:"border p-1 m-1",attrs:{type:"text"},domProps:{value:e.token},on:{change:function(t){e.token=t.target.value}}})]),t("iframe",{ref:"iframe",staticClass:"border fixed h-full w-full top-0",attrs:{src:e.iframeUrl},on:{load:e.onFrameLoad}}),t("MangerPane",{attrs:{manager:e.manager}})],1)},[],!1,null,null,null).exports},9734:function(e,t,r){r.d(t,{Z5:()=>h,to:()=>P,_r:()=>l});var n=r(3438),i=r(3098);let s=".slide-img-container";class l extends i.d{setIframe(e){this.iframe=e;let t=this.iframe.contentDocument.querySelector(s),r=e.contentDocument;this.setParentEl(r.body),this.setScrollEl(t),this._size_obs.observe(t.parentElement),this.setViewEl(t)}setViewEl(e){this._page_obs.observe(e,{attributes:!0}),e.addEventListener("contextmenu",this._onContextmenu),this.viewEl=e}_onMutationObserver(){this.pageIndex=~~this.iframe.contentWindow.curSlide,this.renderFn()}renderFn(){let e=this.viewEl,{list:t,pageIndex:r}=this,n=[];for(let i of t)i.index===r&&(i.pageDom=e,n.push(i));this._tem_box&&n.push(this._tem_box),this.visibleClouds=n,this.render(n)}async create(e,t){this.renderView(),this._tem_box=e,e.manager=this;let r=new AbortController;this.scrollEl.style.touchAction="none";try{await e.create(t)}finally{this.viewEl.style.removeProperty("touch-action"),r.abort()}this._tem_box===e&&(this._tem_box=null)}getAllPage(){return[this.viewEl]}getEventData(e){let t=o(e);return{e:e,index:this.pageIndex,el:t,point:this.getXY(e)}}getXY(e){let t=o(e).getBoundingClientRect();return[(e.clientX-t.left)/t.width,(e.clientY-t.top)/t.height]}async create(e,t){this.renderView(),this._tem_box=e,e.manager=this;let{scrollEl:r,viewEl:n}=this,i=new AbortController;r.style.touchAction="none",n.querySelectorAll("img").forEach(e=>{e.addEventListener("dragstart",function(e){e.preventDefault()},{signal:i.signal})});let s=n.querySelector(".ppt-turn-left-mask"),l=n.querySelector(".ppt-turn-right-mask");try{s&&s.style.setProperty("display","none"),l&&l.style.setProperty("display","none"),await e.create(t)}finally{this.viewEl.style.removeProperty("touch-action"),s&&s.style.removeProperty("display"),l&&l.style.removeProperty("display"),i.abort(),this._tem_box===e&&(this._tem_box=null)}}jump(e){this.iframe.contentWindow.gotoSlide(e.index)}constructor(...e){super(...e),(0,n._)(this,"pageIndex",1)}}function o(e){return e.target.closest(s)}let a=".img-area";class h extends i.d{_onMutationObserver(){let e=this.getAllPage(),t=this._scroll_obs,r=this._size_obs,n=1;for(let i of e)i.dataset.pageNumber=n++,t.observe(i),r.observe(i)}setIframe(e){this.iframe=e;let t=e.contentDocument,r=t.querySelector(".container");this.setScrollEl(r),this.setParentEl(t.body),this.setViewEl(r),this._onMutationObserver()}async create(e,t){this.renderView(),this._tem_box=e,e.manager=this;let r=new AbortController;this.scrollEl.style.touchAction="none",this.viewEl.querySelectorAll("img").forEach(e=>{e.addEventListener("dragstart",function(e){e.preventDefault()},{signal:r.signal})});try{await e.create(t)}finally{this.viewEl.style.removeProperty("touch-action"),r.abort()}this._tem_box===e&&(this._tem_box=null)}getAllPage(){return[...this.viewEl.querySelectorAll(a)]}getEventData(e){let t=c(e);return{e:e,index:~~t.dataset.pageNumber,el:t,point:this.getXY(e)}}getXY(e){let t=c(e).getBoundingClientRect();return[(e.clientX-t.left)/t.width,(e.clientY-t.top)/t.height]}jump(e){let t=e.index,r=this.viewEl.querySelector(`.img-area[data-page-number="${t}"]`);this.jumpToPageAndMark(r,e)}}function c(e){return e.target.closest(a)}var u=r(5738),d=r(9445);let m=function(e,t,r){"__proto__"==t&&d.Z?(0,d.Z)(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r};var g=r(4596),v=Object.prototype.hasOwnProperty;let p=function(e,t,r){var n=e[t];v.call(e,t)&&(0,g.Z)(n,r)&&(void 0!==r||t in e)||m(e,t,r)};var y=r(4542),f=r(1400),_=r(6129),b=r(2452);let w=function(e,t,r,n){if(!(0,_.Z)(e))return e;t=(0,y.Z)(t,e);for(var i=-1,s=t.length,l=s-1,o=e;null!=o&&++i<s;){var a=(0,b.Z)(t[i]),h=r;if("__proto__"===a||"constructor"===a||"prototype"===a)break;if(i!=l){var c=o[a];void 0===(h=n?n(c,a,o):void 0)&&(h=(0,_.Z)(c)?c:(0,f.Z)(t[i+1])?[]:{})}p(o,a,h),o=o[a]}return e};var x=r(5430),E=r(1944);let k=".luckysheetsheetchange";class P extends i.d{_onMutationObserver(){let e=this.iframe.contentDocument,t=e.querySelector("#luckysheet"),r=e.querySelector("#luckysheet-cell-main"),n=this.iframe.contentWindow.luckysheet;this.viewEl=t,this.setScrollEl(r),this.setParentEl(e.body),this.canvas.style.zIndex=1004,r.addEventListener("scroll",this._onPageScroll),this.sheetEl=this.scrollEl.querySelector(".luckysheetsheetchange"),this._luckysheet=n;let i=n.getSheet().index;this.sheetIndex=i}renderFn(){let e=this.sheetEl,{list:t,sheetIndex:r}=this,n=[];for(let i of t)(0,u.Z)(i.index)===(0,u.Z)(r)&&(i.pageDom=e,n.push(i));this._tem_box&&n.push(this._tem_box),this.visibleClouds=n,this.render(n)}setIframe(e){var t,r,n;this.iframe=e;let i=e.contentDocument;t=this.iframe.contentWindow.luckysheetOptions,r="hook.sheetActivate",n=e=>{this.sheetIndex=e,this.renderView()},null==t||w(t,r,n);let s=i.querySelector("#luckysheet");this._page_obs.observe(s,{childList:!0})}async create(e,t){this.renderView(),this._tem_box=e,e.manager=this;let r=new AbortController;this.scrollEl.style.touchAction="none";try{await e.create(t)}finally{this.viewEl.style.removeProperty("touch-action"),r.abort(),this._tem_box===e&&(this._tem_box=null)}console.log(e)}getAllPage(){return[...this.viewEl.querySelectorAll(k)]}getEventData(e){let t=S(e);return{e:e,index:this.sheetIndex,el:t,point:this.getXY(e)}}getXY(e){let t=S(e).getBoundingClientRect();return[(e.clientX-t.left)/t.width,(e.clientY-t.top)/t.height]}jump(e){let t=e.index,r=this._luckysheet.getSheet({index:t});r&&this._luckysheet.setSheetActive(r.order,{success:()=>{let{canvas:t}=this,{points:r,mark:n}=e.data,[i,s]=[...r,...n].reduce((e,t,r)=>(e[r%2].push(t),e),[[],[]]),l=((0,x.Z)(i)+(0,E.Z)(i))/2,o=((0,x.Z)(s)+(0,E.Z)(s))/2,a=this.sheetEl,{height:h,width:c}=t.getBoundingClientRect(),u=a.offsetLeft+a.clientWidth*l-(c>>1),d=a.offsetTop+a.clientHeight*o-(h>>1);this._luckysheet.scroll({scrollLeft:u,scrollTop:d})}})}constructor(...e){super(...e),(0,n._)(this,"sheetEl",void 0),(0,n._)(this,"sheetIndex",1)}}function S(e){return e.target.closest(k)}},3655:function(e,t,r){r.d(t,{u:()=>i});var n=r(5400);let i=(e,t)=>{let r=(0,n.iH)(localStorage.getItem(e)||t),i=(0,n.Fl)(()=>{let e=atob(decodeURIComponent(r.value)),t=Uint8Array.from(e,e=>e.codePointAt(0)),n=new URL(new TextDecoder().decode(t));return n.host=window.location.host,n.href});(0,n.YP)(i,()=>{i.value&&(console.log("change --- ",r.value),localStorage.setItem(e,r.value))});let s=(0,n.Fl)(()=>btoa(Array.from(new TextEncoder().encode(i.value),e=>String.fromCodePoint(e)).join(""))),l=(0,n.Fl)(()=>`/kk/onlinePreview?url=${s.value}`);return{token:r,fileUrl:i,base64:s,iframeUrl:l}}}}]);